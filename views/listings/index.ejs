<% layout('/layouts/boilerplate.ejs') %>

<div id="filters" class="container-fluid px-3 py-2 border-bottom ">
  <div class="d-flex overflow-auto flex-nowrap gap-3 align-items-center">

    <a href="/listings?category=Trending" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Trending' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-chart-line"></i></div>
        <p class="mb-0 small">Trending</p>
      </div>
    </a>

    <a href="/listings?category=Shelter" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Shelter' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-person-shelter"></i></div>
        <p class="mb-0 small">Shelter</p>
      </div>
    </a>

    <a href="/listings?category=Hubs" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Hubs' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-city"></i></div>
        <p class="mb-0 small">Hubs</p>
      </div>
    </a>

    <a href="/listings?category=Mountains" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Mountains' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-mountain-sun"></i></div>
        <p class="mb-0 small">Mountains</p>
      </div>
    </a>

    <a href="/listings?category=Castles" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Castles' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-chess-rook"></i></div>
        <p class="mb-0 small">Castles</p>
      </div>
    </a>

    <a href="/listings?category=Pools" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Pools' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-person-swimming"></i></div>
        <p class="mb-0 small">Pools</p>
      </div>
    </a>

    <a href="/listings?category=Camping" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Camping' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-fire"></i></div>
        <p class="mb-0 small">Camping</p>
      </div>
    </a>

    <a href="/listings?category=Farms" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Farms' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-tractor"></i></div>
        <p class="mb-0 small">Farms</p>
      </div>
    </a>

    <a href="/listings?category=Arctic" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Arctic' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-person-skiing"></i></div>
        <p class="mb-0 small">Arctic</p>
      </div>
    </a>

    <a href="/listings?category=Boating" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'Boating' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-sailboat"></i></div>
        <p class="mb-0 small">Boating</p>
      </div>
    </a>

    <a href="/listings?category=City" class="text-decoration-none text-dark">
      <div class="filter text-center <%= category === 'City' ? 'selected-filter' : '' %>">
        <div><i class="fa-solid fa-tree-city"></i></div>
        <p class="mb-0 small">City</p>
      </div>
    </a>


<small>
<button id="countryFilterBtn" class="btn p-2" style="background-color: white; color: #FF385C; border: none;">
  <div>
    <div class="text-center mt-2  ">
      <i class="fa-solid fa-filter fa-lg"></i>
      <p class="mb-0 small">Filter</p>
    </div>
  </div>
</button>
</small>


<div id="countryFilterDropdown" class="position-absolute bg-white border rounded shadow p-3"
     style="display: none; z-index: 9999; min-width: 250px; max-height: 300px; overflow-y: auto; top: 60px; right: 20px;">
  <form id="countryFilterForm" method="GET" action="/listings">
    <% countries.forEach(country => { %>
      <div class="form-check mb-1">
        <input class="form-check-input" type="checkbox" name="country" value="<%= country %>" id="<%= country %>"
        <%= selectedCountries.includes(country) ? "checked" : "" %>>
        <label class="form-check-label" for="<%= country %>"><%= country %></label>
      </div>
    <% }) %>
    <div class="text-end">
      <button type="submit" class="btn btn-sm btn-danger mt-2">Apply</button>
    </div>
  </form>
</div>




    <!-- Toggle at end -->
    <small>
    <div class="tax-toggle text-nowrap me-auto d-none d-md-block">
      <div class="form-check-reverse form-switch">
        <input class="form-check-input" type="checkbox" id="switchCheckDefault">
        <label class="form-check-label small" for="switchCheckDefault"><b>Total after taxes</b></label>
      </div>
    </div>
    </small>
  </div>
</div>




<div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 row-cols-sm-1">
  <% if (listings.length === 0) { %>
    <div class="col text-center mt-5">
      <h4>No listings found for your search.</h4>
    </div>
  <% } else { %>
    <% for (let listing of listings) { %>
      <a href="/listings/<%= listing._id %>" class="listing-link text-decoration-none text-dark">
        <div class="card col listing-card card-index mb-4 shadow-sm border-0">
          <img src="<%= listing.image.url %>" class="card-img-top rounded-top" alt="Listing_Image" style="height: 20rem; object-fit: cover;">
          <div class="card-img-overlay"></div>
          <div class="card-body">
            <b><%= listing.title %></b>


            <small><p>â‚¹ <%= listing.price.toLocaleString('en-IN') %>/Night<b><i class="tax-info"> &nbsp; +18% GST</i></b></p></small>
            


            <p class="mt-2 mb-1 text-muted small">
              <i class="fa-solid fa-location-dot text-danger me-1"></i>
              <b><%= listing.location %>, <%= listing.country %></b>
            </p>
            <p class="mb-0 text-muted small">
              <i class="fa-solid fa-hashtag text-dark me-1"></i>
              <%= listing.category %>
            </p>
          </div>
        </div>
      </a>
    <% } %>
  <% } %>
</div>



